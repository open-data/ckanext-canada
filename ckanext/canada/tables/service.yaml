# NOTE: Service Inventory Search has been deprecated. Records remain in the Registry DB. (2020-06)
# NOTE: Service Inventory is back in action. (2024-08)
dataset_type: service
target_dataset: service

title: Service Inventory
notes: Access, upload and modify the Service Inventory of external and internal enterprise services for your organization

template_version: 3
template_updated: 2024-11-26  # last qa confirmed: 2025-02-19

portal_type: dataset
collection: service

guide_link: http://www.gcpedia.gc.ca/wiki/GC_Service_Policy_Agenda

resources:
- title: Service Identification Information & Metrics
  resource_name: service

  published_resource_id: c0cf9766-b85b-48c3-b295-34f72305aaf6

  create_form: true
  edit_form: true

  fields:

  # DEP 1-1
  - datastore_id: fiscal_yr
    label:
      en: Fiscal Year
      fr: Année financière
    description:
      en: >
        Identifies the fiscal year (April 1 to March 31) during which service activities took place.
        For example, records for fiscal year 2023-2024 should include applications received
        from April 1, 2023, to March 31, 2024.
      fr: >
        Indique l'exercice financier (1 avril au 31 mars) durant lequel les activités du service ont eu lieu.
        Par exemple, les données pour l’exercice financier 2023-2024 devrait inclure les demandes de service qui
        ont été reçues entre le 1 avril 2023 et le 31 mars 2024.
    obligation: Mandatory
    excel_required: true
    form_required: true
    validation:
      en: This field must not be empty.
      fr: Ce champ ne doit pas être vide.
    occurrence: Single
    datastore_type: text
    choices_file: choices/fiscal_year.yaml

  # DEP 1-2
  - datastore_id: service_id
    label:
      en: Service ID Number
      fr: Numéro d'identification du service
    description:
      en: The unique number assigned to a service in the inventory to make it easier to refer to specific services.
      fr: Le numéro unique attribué à un service dans le répertoire afin de faciliter le référencement à des services précis.
    obligation: Mandatory
    excel_required: true
    form_required: true
    excel_error_formula: 'OR({default_formula},LEN({cell})-LEN(SUBSTITUTE({cell},",",""))>0)'
    format_type: Free text
    validation:
      en: |
        This field must not be empty.
        This field cannot contain commas.
      fr: |
        Ce champ ne doit pas être vide.
        Ce champ ne peut pas contenir de virgules.
    occurrence: Single
    datastore_type: text

  # DEP 1-4
  - datastore_id: service_name_en
    label:
      en: Service Name (English)
      fr: Nom du service (en anglais)
    description:
      en: Identifies the official name of the service.
      fr: Indique le nom officiel du service.
    obligation: Mandatory
    excel_required: true
    excel_column_width: 40
    form_required: true
    format_type: Free text
    validation:
      en: |
        This field must not be empty.
        This field has a maximum length of 350 characters.
      fr: |
        Ce champ ne doit pas être vide.
        Ce champ ne peut excéder une longueur maximale de 350 caractères.
    occurrence: Single
    datastore_type: text
    max_chars: 350
    form_attrs:
      style: "width: 100%; display: block"
      maxlength: 350

  # DEP 1-5
  - datastore_id: service_name_fr
    label:
      en: Service Name (French)
      fr: Nom du service (en français)
    description:
      en: Identifies the official name of the service.
      fr: Indique le nom officiel du service.
    obligation: Mandatory
    excel_required: true
    excel_column_width: 40
    form_required: true
    format_type: Free text
    validation:
      en: |
        This field must not be empty.
        This field has a maximum length of 350 characters.
      fr: |
        Ce champ ne doit pas être vide.
        Ce champ ne peut excéder une longueur maximale de 350 caractères.
    occurrence: Single
    datastore_type: text
    max_chars: 350
    form_attrs:
      style: "width: 100%; display: block"
      maxlength: 350

  # DEP 1-6
  - datastore_id: service_description_en
    label:
      en: Service Description (English)
      fr: Description du service (en anglais)
    description:
      en: Provides a brief description of the service, in plain language.
      fr: Offre une brève description du service, en langage simple.
    obligation: Mandatory
    excel_required: true
    excel_column_width: 80
    form_required: true
    format_type: Free text
    validation:
      en: |
        This field must not be empty.
        This field has a maximum length of 1800 characters.
      fr: |
        Ce champ ne doit pas être vide.
        Ce champ ne peut excéder une longueur maximale de 1800 caractères.
    occurrence: Single
    datastore_type: text
    max_chars: 1800
    form_snippet: scheming/form_snippets/textarea.html
    form_attrs:
      maxlength: 1800

  # DEP 1-7
  - datastore_id: service_description_fr
    label:
      en: Service Description (French)
      fr: Description du service (en français)
    description:
      en: Provides a brief description of the service, in plain language.
      fr: Offre une brève description du service, en langage simple.
    obligation: Mandatory
    excel_required: true
    excel_column_width: 80
    form_required: true
    format_type: Free text
    validation:
      en: |
        This field must not be empty.
        This field has a maximum length of 1800 characters.
      fr: |
        Ce champ ne doit pas être vide.
        Ce champ ne peut excéder une longueur maximale de 1800 caractères.
    occurrence: Single
    datastore_type: text
    max_chars: 1800
    form_snippet: scheming/form_snippets/textarea.html
    form_attrs:
      maxlength: 1800

  # DEP 1-8
  - datastore_id: service_type
    label:
      en: Service Type
      fr: Type de service
    description:
      en: Identifies the service type as outlined in the Guideline on Service and Digital. Multiple values must be separated by a comma (,).
      fr: Indique le type de service tel qu'indiqué dans la Ligne directrice sur les services et le numérique. Séparez les entrées par une virgule (,) s’il y en a plusieurs qui s’appliquent.
    obligation: Mandatory
    excel_required: true
    form_required: true
    format_type: Controlled List
    validation:
      en: This field must not be empty.
      fr: Ce champ ne doit pas être vide.
    occurrence: Repeatable
    datastore_type: _text
    excel_full_text_choices: false
    form_snippet: scheming/form_snippets/multiple_select.html
    choices:
      APIR:
        en: Agreements, Permissions, Inspections, Rulings
        fr: Accords, autorisations, inspections, décisions
      CER:
        en: Care, Education, Recreation
        fr: Soins, éducation, loisirs
      GNC:
        en: Grants and Contributions
        fr: Subventions et contributions
      INFO:
        en: Information
        fr: Informations
      LRP:
        en: Legislation, Regulation, Policy
        fr: Législation, réglementation, politique
      PPI:
        en: Penalties, Protection, Intervention
        fr: Pénalités, protection, interventions
      REG_VOL:
        en: High Volume Regulatory Transactions
        fr: Opérations réglementaires à demande élevée
      RES:
        en: Resources
        fr: Ressources

  # DEP 1-9
  - datastore_id: service_recipient_type
    label:
      en: Service Recipient Type
      fr: Type de bénéficiaire du service
    description:
      en: >
        Targeted, client-based services: serve specific clients or groups, such as people, businesses,
        GC employees. Untargeted, Societal-based Service: serve society, not distinct people or groups,
        such as military, pure science.
      fr: >
        Services ciblés axés sur les clients : Répondent aux besoins de clients ou de groupes particuliers,
        par exemple les personnes, les entreprises ou les employés du GC. Services non ciblés axés sur la
        société : Répondent aux besoins de la société en général et non aux besoins de personnes ou de
        groupes distincts, par exemple les forces armées ou la science pure.
    obligation: Mandatory
    excel_required: true
    form_required: true
    format_type: Controlled List
    validation:
      en: This field must not be empty.
      fr: Ce champ ne doit pas être vide.
    occurrence: Single
    datastore_type: text
    excel_full_text_choices: true
    choices:
      CLIENT:
        en: Targeted, Client-based service
        fr: Service ciblé, axé sur les clients
      SOCIETY:
        en: Untargeted, Societal-based service
        fr: Service non-ciblé, axé sur la société

  # DEP 1-10
  - datastore_id: service_scope
    label:
      en: Service Scope
      fr: Étendue du service
    description:
      en: Indicates whether the service is external or internal to government. Multiple values must be separated by a comma (,).
      fr: Indique si le service est offert aux clients externes ou internes au gouvernement. Séparez les entrées par une virgule (,) s’il y en a plusieurs qui s’appliquent.
    obligation: Mandatory
    excel_required: true
    form_required: true
    format_type: Controlled List
    validation:
      en: This field must not be empty.
      fr: Ce champ ne doit pas être vide.
    occurrence: Repeatable
    datastore_type: _text
    excel_full_text_choices: false
    form_snippet: scheming/form_snippets/multiple_select.html
    choices:
      CLUSTER:
        en: Internal Cluster Service
        fr: Service cluster interne
      ENTERPRISE:
        en: Internal Enterprise Service
        fr: Service interne intégré
      EXTERN:
        en: External Service
        fr: Service externe
      INTERN:
        en: Internal Service
        fr: Service interne

  # DEP 1-11
  - datastore_id: client_target_groups
    label:
      en: Client/Target Groups
      fr: Clients/groupes cibles
    description:
      en: Identifies the clients or target groups of the service. Multiple values must be separated by a comma (,).
      fr: Identifie les clients ou les groupes de services cibles. Séparez les entrées par une virgule (,) s’il y en a plusieurs qui s’appliquent.
    obligation: Mandatory
    excel_required: true
    form_required: true
    format_type: Controlled List
    validation:
      en: This field must not be empty.
      fr: Ce champ ne doit pas être vide.
    occurrence: Repeatable
    datastore_type: _text
    excel_full_text_choices: false
    form_snippet: scheming/form_snippets/multiple_select.html
    choices:
      ECONOM:
        en: Economic Segments (Businesses)
        fr: Segments économiques (entreprises)
      FOR:
        en: Foreign Entities
        fr: Entités étrangères
      INTERN_GOV:
        en: Internal to Government
        fr: Interne au gouvernement
      NGO:
        en: Non Profit Institutions and Organizations
        fr: Institutions et organismes sans but lucratif
      PERSON:
        en: Persons
        fr: Particuliers
      PTC:
        en: Provinces, Territories or Communities
        fr: Provinces, territoires et collectivités

  # DEP 1-12
  - datastore_id: program_id
    label:
      en: Program ID Code
      fr: Code d'identification du programme
    description:
      en: >
        Identifies the unique program code associated with program elements for all
        strategic outcomes, programs, sub-programs, and sub-sub-programs. The Program
        codes in the government-wide Chart of Accounts can be used. Corporate planners
        in the department/agency who are responsible for the Policy on Results can
        assist in identifying this, if needed. Multiple values must be separated by a comma (,).
      fr: >
        Indique le code de programme unique associé aux éléments de programme pour tous
        les résultats stratégiques, les programmes, les sous-programmes et les sous-sous-programmes.
        Les planificateurs ministériels du ministère ou de l'organisme responsables de la
        Politique sur les résultats peuvent aider à déterminer le code d'identification du
        programme, au besoin. Séparez les entrées par une virgule (,) s’il y en a plusieurs qui s’appliquent.
    obligation: Mandatory
    excel_required: true
    form_required: true
    format_type: Controlled List
    validation:
      en: This field must not be empty.
      fr: Ce champ ne doit pas être vide.
    occurrence: Repeatable
    datastore_type: _text
    excel_full_text_choices: false
    form_snippet: scheming/form_snippets/multiple_select.html
    choices_file: choices/service_program_names.yaml
    form_choices_prefix_code: true
    form_select_attrs:
      class: form-control recombinant-select2

  # DEP 1-13
  # Dev: Published Resource Field
  - datastore_id: program_name_en
    label:
      en: Program Name (English)
      fr: Désignation du programme (en anglais)
    description:
      en: Identifies the name of the program under which the service is delivered.
      fr: Indique le nom du programme sous lequel le service est offert.
    obligation: Mandatory
    occurrence: Repeatable
    datastore_type: _text
    published_resource_computed_field: true

  # DEP 1-14
  # Dev: Published Resource Field
  - datastore_id: program_name_fr
    label:
      en: Program Name (French)
      fr: Désignation du programme (en français)
    description:
      en: Identifies the name of the program under which the service is delivered.
      fr: Indique le nom du programme sous lequel le service est offert.
    obligation: Mandatory
    occurrence: Repeatable
    datastore_type: _text
    published_resource_computed_field: true

  # DEP 1-15
  - datastore_id: client_feedback_channel
    label:
      en: Client Feedback, by Channel
      fr: Commentaires des clients, par canal
    description:
      en: >
        Identifies which channels, if any, provide users of a service an opportunity to provide feedback
        on their level of satisfaction with the service. Multiple values must be separated by a comma (,).
      fr: >
        Détermine quels canaux, s'il y a lieu, offrent aux utilisateurs d'un service l'occasion de donner
        une rétroaction sur leur niveau de satisfaction à l'égard du service. Séparez les entrées par une
        virgule (,) s’il y en a plusieurs qui s’appliquent.
    obligation: Mandatory
    excel_required: true
    form_required: true
    format_type: Controlled List
    validation:
      en: This field must not be empty.
      fr: Ce champ ne doit pas être vide.
    occurrence: Repeatable
    datastore_type: _text
    excel_full_text_choices: false
    form_snippet: scheming/form_snippets/multiple_select.html
    choices:
      EML:
        en: Email
        fr: Courriel
      FAX:
        en: Fax
        fr: Télécopieur
      NON:
        en: No feedback collected
        fr: Aucune rétroaction possible
      ONL:
        en: Online
        fr: En ligne
      OTH:
        en: Other channel not listed
        fr: Autre option qui n'est pas sur la liste
      PERSON:
        en: In-Person
        fr: En personne
      POST:
        en: Postal Mail
        fr: Courrier postal
      TEL:
        en: Telephone
        fr: Téléphone

  # DEP 1-16
  - datastore_id: automated_decision_system
    label:
      en: Automated Decision System
      fr: Système décisionnel automatisé
    description:
      en: >
        An automated decision system is defined in the Directive on Automated Decision-Making
        and means any technology that either assists or replaces the judgment of human
        decision-makers, such as those that draw from fields like statistics, linguistics and
        computer science, and use techniques such as rules-based systems, regression, predictive
        analytics, machine learning, deep learning, and neural networks.
      fr: >
        Un système décisionnel automatisé est défini dans la Directive sur la prise de décisions
        automatisée et désigne toute technologie qui assiste ou remplace le jugement des décideurs
        humains, comme ceux qui proviennent de domaines tels que les statistiques, la linguistique
        et les sciences informatiques, et utilisent des techniques telles que les systèmes basés
        sur des règles, la régression, l’analytique prédictive, l’apprentissage automatique,
        l’apprentissage en profondeur et les réseaux neuronaux.
    obligation: Mandatory
    excel_required: true
    form_required: true
    format_type: Controlled List
    validation:
      en: This field must not be empty.
      fr: Ce champ ne doit pas être vide.
    occurrence: Single
    datastore_type: text
    excel_full_text_choices: true
    choices_file: choices/yes_no.yaml
    form_snippet: scheming/form_snippets/radio.html

  # DEP 1-17
  - datastore_id: automated_decision_system_description_en
    label:
      en: Automated Decision System Description (English)
      fr: Description du système décisionnel automatisé (anglais)
    description:
      en: >
        Describe what the system does. Include: the name or title of the system,
        the role of the system in the decision, whether it is full or partial
        automation, and how officers use the system to make or inform the decision.
      fr: >
        Décrivez ce que fait le système. Inclure : le nom ou titre du système, le
        rôle du système dans la prise de décision, s'il s'agit d'une automatisation
        complète ou partielle, et comment les agents utilisent le système pour
        prendre ou informer la décision.
    #FIXME: specify if automated_decision_system is Y/YES ??
    obligation: Optional
    excel_required: false
    excel_column_width: 80
    format_type: Free text
    validation:
      en: |
        This field is required due to a response in a different field.
        This field has a maximum length of 1800 characters.
      fr: |
        Ce champ est requis en raison d'une réponse présente dans un autre champ.
        Ce champ ne peut excéder une longueur maximale de 1800 caractères.
    occurrence: Single
    datastore_type: text
    max_chars: 1800
    excel_required_formula: 'OR(TRIM(LEFT({automated_decision_system},FIND(":",{automated_decision_system}&":")-1))="Y",NOT(ISBLANK({automated_decision_system_description_fr})))'
    form_snippet: scheming/form_snippets/textarea.html
    form_attrs:
      maxlength: 1800

  # DEP 1-18
  - datastore_id: automated_decision_system_description_fr
    label:
      en: Automated Decision System Description (French)
      fr: Description du système décisionnel automatisé (français)
    description:
      en: >
        Describe what the system does. Include: the name or title of the system,
        the role of the system in the decision, whether it is full or partial
        automation, and how officers use the system to make or inform the decision.
      fr: >
        Décrivez ce que fait le système. Inclure : le nom ou titre du système, le
        rôle du système dans la prise de décision, s'il s'agit d'une automatisation
        complète ou partielle, et comment les agents utilisent le système pour
        prendre ou informer la décision.
    #FIXME: specify if automated_decision_system is Y/YES ??
    obligation: Optional
    excel_required: false
    excel_column_width: 80
    format_type: Free text
    validation:
      en: |
        This field is required due to a response in a different field.
        This field has a maximum length of 1800 characters.
      fr: |
        Ce champ est requis en raison d'une réponse présente dans un autre champ.
        Ce champ ne peut excéder une longueur maximale de 1800 caractères.
    occurrence: Single
    datastore_type: text
    max_chars: 1800
    excel_required_formula: 'OR(TRIM(LEFT({automated_decision_system},FIND(":",{automated_decision_system}&":")-1))="Y",NOT(ISBLANK({automated_decision_system_description_en})))'
    form_snippet: scheming/form_snippets/textarea.html
    form_attrs:
      maxlength: 1800

  # DEP 1-19
  - datastore_id: service_fee
    label:
      en: Service Fees
      fr: Frais de service
    description:
      en: Identifies whether a service fee is collected for the provision of the service.
      fr: Indique si des frais de service sont perçus pour la prestation du service.
    obligation: Mandatory
    excel_required: true
    form_required: true
    format_type: Controlled List
    validation:
      en: This field must not be empty.
      fr: Ce champ ne doit pas être vide.
    occurrence: Single
    datastore_type: text
    excel_full_text_choices: true
    choices_file: choices/yes_no.yaml
    form_snippet: scheming/form_snippets/radio.html

  # DEP 1-20
  - datastore_id: os_account_registration
    label:
      en: "Online Services: Account Registration/Enrollment"
      fr: "Services en ligne : Enregistrement/inscription du compte"
    description:
      en: >
        Identifies whether a client can register or enroll for a personal account
        where they can make use of other interaction points (applying for services,
        providing information, seeing their status, submitting feedback, etc.).
      fr: >
        Indique si un client peut s'inscrire ou s'inscrire à un compte personnel où
        il peut utiliser d'autres points d'interaction (demander des services, fournir
        des renseignements, voir son statut, soumettre des commentaires, etc.).
    obligation: Mandatory
    excel_required: true
    form_required: true
    format_type: Controlled List
    validation:
      en: This field must not be empty.
      fr: Ce champ ne doit pas être vide.
    occurrence: Single
    datastore_type: text
    excel_full_text_choices: true
    choices_file: choices/online_service_yes_no.yaml
    form_snippet: scheming/form_snippets/radio.html

  # DEP 1-21
  - datastore_id: os_authentication
    label:
      en: "Online Services: Authentication"
      fr: "Services en ligne : Authentification"
    description:
      en: Identifies whether a client can authenticate their identity online.
      fr: Indique si un client peut confirmer son identité en ligne.
    obligation: Mandatory
    excel_required: true
    form_required: true
    format_type: Controlled List
    validation:
      en: This field must not be empty.
      fr: Ce champ ne doit pas être vide.
    occurrence: Single
    datastore_type: text
    excel_full_text_choices: true
    choices_file: choices/online_service_yes_no.yaml
    form_snippet: scheming/form_snippets/radio.html

  # DEP 1-22
  - datastore_id: os_application
    label:
      en: "Online Services: Application"
      fr: "Services en ligne : Demande"
    description:
      en: Identifies whether a client can apply for a service online.
      fr: Indique si un client peut présenter une demande de service en ligne.
    obligation: Mandatory
    excel_required: true
    form_required: true
    format_type: Controlled List
    validation:
      en: This field must not be empty.
      fr: Ce champ ne doit pas être vide.
    occurrence: Single
    datastore_type: text
    excel_full_text_choices: true
    choices_file: choices/online_service_yes_no.yaml
    form_snippet: scheming/form_snippets/radio.html

  # DEP 1-23
  - datastore_id: os_decision
    label:
      en: "Online Services: Decision"
      fr: "Services en ligne : Décision"
    description:
      en: Identifies whether a client can be notified online of the outcome of their request for this service.
      fr: Indique si un client peut être informé en ligne du résultat de sa demande de ce service.
    obligation: Mandatory
    excel_required: true
    form_required: true
    format_type: Controlled List
    validation:
      en: This field must not be empty.
      fr: Ce champ ne doit pas être vide.
    occurrence: Single
    datastore_type: text
    excel_full_text_choices: true
    choices_file: choices/online_service_yes_no.yaml
    form_snippet: scheming/form_snippets/radio.html

  # DEP 1-24
  - datastore_id: os_issuance
    label:
      en: "Online Services: Issuance"
      fr: "Services en ligne : Émission"
    description:
      en: Identifies whether a client can receive the service online, perhaps in the form of permits, certificates, money or information.
      fr: Indique si un client peut recevoir le service en ligne, peut-être sous forme de permis, de certificats, d'argent ou d'information.
    obligation: Mandatory
    excel_required: true
    form_required: true
    format_type: Controlled List
    validation:
      en: This field must not be empty.
      fr: Ce champ ne doit pas être vide.
    occurrence: Single
    datastore_type: text
    excel_full_text_choices: true
    choices_file: choices/online_service_yes_no.yaml
    form_snippet: scheming/form_snippets/radio.html

  # DEP 1-25
  - datastore_id: os_issue_resolution_feedback
    label:
      en: "Online Services: Issue Resolution and Feedback"
      fr: "Services en ligne : Solution de problème et rétroaction"
    description:
      en: Identifies whether a client can seek resolution to their issues or provide feedback online.
      fr: Indique si un client peut demander une résolution à leur problèmes avec le service ou fournir de la rétroaction en ligne.
    obligation: Mandatory
    excel_required: true
    form_required: true
    format_type: Controlled List
    validation:
      en: This field must not be empty.
      fr: Ce champ ne doit pas être vide.
    occurrence: Single
    datastore_type: text
    excel_full_text_choices: true
    choices_file: choices/online_service_yes_no.yaml
    form_snippet: scheming/form_snippets/radio.html

  # DEP 1-26
  - datastore_id: os_comments_client_interaction_en
    label:
      en: "Comments on Online Services - Client Interaction Points (English)"
      fr: "Commentaires sur les services électroniques - points d'interaction avec les clients (anglais)"
    description:
      en: >
        Comments related to online services - client Interaction points (English). For
        any interaction points reported as "Not Applicable", comments have to be provided.
      fr: >
        Commentaires en lien avec les services électroniques - points d'interaction avec les
        clients (anglais). Pour tout points d'interaction signalés comme « sans objet »,
        des commentaires doivent être fournis.
    #FIXME: specify if any "Online Service" fields are NA ??
    obligation: Optional
    excel_required: false
    excel_column_width: 80
    format_type: Free text
    validation:
      en: |
        This field is required due to a response in a different field.
        This field has a maximum length of 1000 characters.
      fr: |
        Ce champ est requis en raison d'une réponse présente dans un autre champ.
        Ce champ ne peut excéder une longueur maximale de 1000 caractères.
    occurrence: Single
    datastore_type: text
    max_chars: 1000
    excel_required_formula: 'OR(TRIM(LEFT({os_account_registration},FIND(":",{os_account_registration}&":")-1))="NA",TRIM(LEFT({os_authentication},FIND(":",{os_authentication}&":")-1))="NA",TRIM(LEFT({os_application},FIND(":",{os_application}&":")-1))="NA",TRIM(LEFT({os_decision},FIND(":",{os_decision}&":")-1))="NA",TRIM(LEFT({os_issuance},FIND(":",{os_issuance}&":")-1))="NA",TRIM(LEFT({os_issue_resolution_feedback},FIND(":",{os_issue_resolution_feedback}&":")-1))="NA",NOT(ISBLANK({os_comments_client_interaction_fr})))'
    form_snippet: scheming/form_snippets/textarea.html
    form_attrs:
      maxlength: 1000

  # DEP 1-27
  - datastore_id: os_comments_client_interaction_fr
    label:
      en: "Comments on Online Services - Client Interaction Points (French)"
      fr: "Commentaires sur les services électroniques - points d'interaction avec les clients (français)"
    description:
      en: >
        Comments related to online services - client Interaction points (French). For any
        interaction points reported as "Not Applicable", comments have to be provided.
      fr: >
        Commentaires en lien avec les services électroniques - points d'interaction avec
        les clients (français). Pour tout points d'interaction signalés comme « sans objet »,
        des commentaires doivent être fournis.
    #FIXME: specify if any "Online Service" fields are NA ??
    obligation: Optional
    excel_required: false
    excel_column_width: 80
    format_type: Free text
    validation:
      en: |
        This field is required due to a response in a different field.
        This field has a maximum length of 1000 characters.
      fr: |
        Ce champ est requis en raison d'une réponse présente dans un autre champ.
        Ce champ ne peut excéder une longueur maximale de 1000 caractères.
    occurrence: Single
    datastore_type: text
    max_chars: 1000
    excel_required_formula: 'OR(TRIM(LEFT({os_account_registration},FIND(":",{os_account_registration}&":")-1))="NA",TRIM(LEFT({os_authentication},FIND(":",{os_authentication}&":")-1))="NA",TRIM(LEFT({os_application},FIND(":",{os_application}&":")-1))="NA",TRIM(LEFT({os_decision},FIND(":",{os_decision}&":")-1))="NA",TRIM(LEFT({os_issuance},FIND(":",{os_issuance}&":")-1))="NA",TRIM(LEFT({os_issue_resolution_feedback},FIND(":",{os_issue_resolution_feedback}&":")-1))="NA",NOT(ISBLANK({os_comments_client_interaction_en})))'
    form_snippet: scheming/form_snippets/textarea.html
    form_attrs:
      maxlength: 1000

  # DEP 1-28
  - datastore_id: last_service_review
    label:
      en: Year of last service review
      fr: Année du dernier examen de service
    description:
      en: Identifies the fiscal year when the most recent service review was completed.
      fr: Identifie l’exercice lors duquel le plus récent examen de service a été mené.
    obligation: Optional
    excel_required: false
    form_required: false
    occurrence: Single
    datastore_type: text
    excel_full_text_choices: false
    choices_file: choices/fiscal_year.yaml

  # DEP 1-29
  - datastore_id: last_service_improvement
    label:
      en: Year of last service improvement based on client feedback
      fr: Année de la dernière amélioration du service sur la base de la rétroaction du client
    description:
      en: What was the most recent year in which this service was improved based on client feedback?
      fr: Quelle a été l'année la plus récente au cours de laquelle ce service a été amélioré en fonction des commentaires des clients?
    obligation: Optional
    excel_required: false
    form_required: false
    occurrence: Single
    datastore_type: text
    excel_full_text_choices: false
    choices_file: choices/fiscal_year.yaml

  # DEP 1-30
  - datastore_id: sin_usage
    label:
      en: Use of Social Insurance Number
      fr: Utilisation du numéro d'assurance sociale (NAS)
    description:
      en: Identifies whether the Social Insurance Number (SIN) is used in the delivery of the service.
      fr: Indique si le numéro d'assurance sociale (NAS) est utilisé dans la prestation du service.
    obligation: Mandatory
    excel_required: true
    form_required: true
    format_type: Controlled List
    validation:
      en: This field must not be empty.
      fr: Ce champ ne doit pas être vide.
    occurrence: Single
    datastore_type: text
    excel_full_text_choices: true
    choices:
      'NA':
        en: N/A (not a service to individuals)
        fr: S.O. (N'est pas un service aux particuliers)
      'N':
        en: "No"
        fr: Non
      'Y':
        en: "Yes"
        fr: Oui
    form_snippet: scheming/form_snippets/radio.html

  # DEP 1-31
  - datastore_id: cra_bn_identifier_usage
    label:
      en: Use of CRA Business Number as Standard Identifier
      fr: Utilisation du numéro d’entreprise de l’ARC en tant qu’identificateur standard
    description:
      en: >
        Identifies whether the Canada Revenue Agency's Business Number is used in the
        delivery of the service as the standard identifier in accordance with the Directive
        on the Business Number.
      fr: >
        Indique si le numéro d’entreprise de l’Agence du revenu du Canada est utilisé dans
        la prestation des services en tant qu’identificateur standard, conformément à la
        Directive sur le numéro d’entreprise.
    obligation: Mandatory
    excel_required: true
    form_required: true
    format_type: Controlled List
    validation:
      en: This field must not be empty.
      fr: Ce champ ne doit pas être vide.
    occurrence: Single
    datastore_type: text
    excel_full_text_choices: true
    choices:
      'NA':
        en: N/A (not a service to businesses)
        fr: S.O. (N'est pas un service aux entreprises)
      'N':
        en: "No"
        fr: Non
      'Y':
        en: "Yes"
        fr: Oui
    form_snippet: scheming/form_snippets/radio.html

  # DEP 1-32
  - datastore_id: num_phone_enquiries
    label:
      en: Number of Telephone Enquiries Received
      fr: Nombre des demandes téléphoniques reçus
    description:
      en: >
        Identifies the number of enquiries about the service received
        in this fiscal year. Note: This field represents only requests
        for information about the service. Report service requests or
        applications submitted by telephone in the "telephone applications"
        field. A value of 0 means no calls were received; ND means no data
        was collected; and NA means it is not possible to submit telephone enquiries.
      fr: >
        Indique le nombre de demandes d'information reçues par téléphone au cours
        d'un exercice financier. Remarque : Ce champ indique seulement le nombre
        de demandes d'information au sujet d'un service. Servez-vous du champ
        "telephone applications" pour les demandes de prestation de service
        reçues par téléphone.
    obligation: Mandatory
    excel_required: true
    form_required: true
    format_type: Free text
    validation:
      en: |
        This field must not be empty.
        This field must be either a number, "NA", or "ND"
        This value must not be negative.
      fr: |
        Ce champ ne doit pas être vide.
        Ce champ doit être un chiffre, "NA", ou "ND"
        Cette valeur ne doit être négative.
    occurrence: Single
    datastore_type: text
    excel_error_formula: 'OR({default_formula},IFERROR(VALUE({cell})<0,AND({cell}<>"NA",{cell}<>"ND")))'

  # DEP 1-33
  - datastore_id: num_applications_by_phone
    label:
      en: Number of Applications Submitted by Telephone
      fr: Nombre de demandes soumises par téléphone
    description:
      en: >
        Identifies the number of applications submitted in a fiscal year for the
        telephone channel. A value of 0 means no applications were received for
        this channel; ND means there is no data collected for this channel; and
        NA means no applications can be submitted through this channel.
      fr: >
        Indique le nombre de demandes reçues par téléphone au cours d'un exercice.
        La valeur 0 signifie qu'aucune demande n'a été reçue via ce mode de prestation,
        aucune donnée (ND) signifie qu'aucune donnée n’est disponible, et sans objet (NA)
        signifie que le service n’est pas offert au moyen de ce mode de prestation.
    obligation: Mandatory
    excel_required: true
    form_required: true
    format_type: Free text
    validation:
      en: |
        This field must not be empty.
        This field must be either a number, "NA", or "ND"
        This value must not be negative.
      fr: |
        Ce champ ne doit pas être vide.
        Ce champ doit être un chiffre, "NA", ou "ND"
        Cette valeur ne doit être négative.
    occurrence: Single
    datastore_type: text
    excel_error_formula: 'OR({default_formula},IFERROR(VALUE({cell})<0,AND({cell}<>"NA",{cell}<>"ND")))'

  # DEP 1-34
  - datastore_id: num_website_visits
    label:
      en: Number of Website Visits
      fr: Nombre de visites sur le site Web
    description:
      en: >
        Identifies the number of visits to the service's website in a fiscal year.
        A value of 0 means there were no visits; ND means there is no data collected
        website visits; and NA means there is no associated public website.
      fr: >
        Indique le nombre de de visites au site web du service lors d'un exercice
        financier. La valeur 0 signifie qu'aucune visite au site web n’a été enregistrée,
        aucune donnée (ND) signifie que le nombre de visites n’est pas mesuré, et sans
        objet (NA) signifie qu’il n’y a aucune site web à visiter.
    obligation: Mandatory
    excel_required: true
    form_required: true
    format_type: Free text
    validation:
      en: |
        This field must not be empty.
        This field must be either a number, "NA", or "ND"
        This value must not be negative.
      fr: |
        Ce champ ne doit pas être vide.
        Ce champ doit être un chiffre, "NA", ou "ND"
        Cette valeur ne doit être négative.
    occurrence: Single
    datastore_type: text
    excel_error_formula: 'OR({default_formula},IFERROR(VALUE({cell})<0,AND({cell}<>"NA",{cell}<>"ND")))'

  # DEP 1-35
  - datastore_id: num_applications_online
    label:
      en: Number of Applications Submitted Online
      fr: Nombre de demandes soumises en ligne
    description:
      en: >
        Identifies the number of applications submitted in a fiscal year
        for the online channel. A value of 0 means no applications were
        received for this channel; ND means there is no data collected for
        this channel; and NA means no applications can be submitted through
        this channel.
      fr: >
        Indique le nombre de demandes reçues en ligne au cours d'un exercice.
        La valeur 0 signifie qu'aucune demande n'a été reçue via ce mode de
        prestation, aucune donnée (ND) signifie qu'aucune donnée n’est disponible,
        et sans objet (NA) signifie que le service n’est pas offert au moyen de
        ce mode de prestation.
    obligation: Mandatory
    excel_required: true
    form_required: true
    format_type: Free text
    validation:
      en: |
        This field must not be empty.
        This field must be either a number, "NA", or "ND"
        This value must not be negative.
      fr: |
        Ce champ ne doit pas être vide.
        Ce champ doit être un chiffre, "NA", ou "ND"
        Cette valeur ne doit être négative.
    occurrence: Single
    datastore_type: text
    excel_error_formula: 'OR({default_formula},IFERROR(VALUE({cell})<0,AND({cell}<>"NA",{cell}<>"ND")))'

  # DEP 1-36
  - datastore_id: num_applications_in_person
    label:
      en: Number of Applications Submitted In-Person
      fr: Nombre de demandes soumises en personne
    description:
      en: >
        Identifies number of applications received in-person in a fiscal year
        for the service. A value of 0 means no applications were received for
        this channel; ND means there is no data collected for this channel;
        and NA means no applications can be submitted through this channel.
      fr: >
        Indique le nombre de demandes reçues en personne au cours d'un exercice.
        La valeur 0 signifie qu'aucune demande n'a été reçue via ce mode de
        prestation, aucune donnée (ND) signifie qu'aucune donnée n’est disponible,
        et sans objet (NA) signifie que le service n’est pas offert au moyen de
        ce mode de prestation.
    obligation: Mandatory
    excel_required: true
    form_required: true
    format_type: Free text
    validation:
      en: |
        This field must not be empty.
        This field must be either a number, "NA", or "ND"
        This value must not be negative.
      fr: |
        Ce champ ne doit pas être vide.
        Ce champ doit être un chiffre, "NA", ou "ND"
        Cette valeur ne doit être négative.
    occurrence: Single
    datastore_type: text
    excel_error_formula: 'OR({default_formula},IFERROR(VALUE({cell})<0,AND({cell}<>"NA",{cell}<>"ND")))'

  # DEP 1-37
  - datastore_id: num_applications_by_mail
    label:
      en: Number of Applications Submitted via Postal Mail
      fr: Nombre de demandes soumises par la poste
    description:
      en: >
        Identifies the number of applications received through postal mail in a fiscal
        year. A value of 0 means no applications were received for this channel;
        ND means there is no data collected for this channel; and NA means no applications
        can be submitted through this channel.
      fr: >
        Indique le nombre de demandes reçues par la poste au cours d'un exercice.
        La valeur 0 signifie qu'aucune demande n'a été reçue via ce mode de prestation,
        aucune donnée (ND) signifie qu'aucune donnée n’est disponible, et sans objet (NA)
        signifie que le service n’est pas offert au moyen de ce mode de prestation.
    obligation: Mandatory
    excel_required: true
    form_required: true
    format_type: Free text
    validation:
      en: |
        This field must not be empty.
        This field must be either a number, "NA", or "ND"
        This value must not be negative.
      fr: |
        Ce champ ne doit pas être vide.
        Ce champ doit être un chiffre, "NA", ou "ND"
        Cette valeur ne doit être négative.
    occurrence: Single
    datastore_type: text
    excel_error_formula: 'OR({default_formula},IFERROR(VALUE({cell})<0,AND({cell}<>"NA",{cell}<>"ND")))'

  # DEP 1-38
  - datastore_id: num_applications_by_email
    label:
      en: Number of Applications Submitted by Email
      fr: Nombre de demandes soumises par courriel
    description:
      en: >
        Identifies the number of applications received through email in a fiscal
        year for the service. A value of 0 means no applications were received for
        this channel; ND means there is no data collected for this channel; and
        NA means no applications can be submitted through this channel.
      fr: >
        Indique le nombre de demandes reçues par courriel au cours d'un exercice.
        La valeur 0 signifie qu'aucune demande n'a été reçue via ce mode de prestation,
        aucune donnée (ND) signifie qu'aucune donnée n’est disponible, et sans objet
        (NA) signifie que le service n’est pas offert au moyen de ce mode de prestation.
    obligation: Mandatory
    excel_required: true
    form_required: true
    format_type: Free text
    validation:
      en: |
        This field must not be empty.
        This field must be either a number, "NA", or "ND"
        This value must not be negative.
      fr: |
        Ce champ ne doit pas être vide.
        Ce champ doit être un chiffre, "NA", ou "ND"
        Cette valeur ne doit être négative.
    occurrence: Single
    datastore_type: text
    excel_error_formula: 'OR({default_formula},IFERROR(VALUE({cell})<0,AND({cell}<>"NA",{cell}<>"ND")))'

  # DEP 1-39
  - datastore_id: num_applications_by_fax
    label:
      en: Number of Applications Submitted by Fax
      fr: Nombre de demandes soumises par fax
    description:
      en: >
        Identifies the number of applications received through fax in a fiscal
        year for the service. A value of 0 means no applications were received
        for this channel; ND means there is no data collected for this channel;
        and NA means no applications can be submitted through this channel.
      fr: >
        Indique le nombre de demandes reçues par télécopieur au cours d'un exercice.
        La valeur 0 signifie qu'aucune demande n'a été reçue via ce mode de prestation,
        aucune donnée (ND) signifie qu'aucune donnée n’est disponible, et sans objet
        (NA) signifie que le service n’est pas offert au moyen de ce mode de prestation.
    obligation: Mandatory
    excel_required: true
    form_required: true
    format_type: Free text
    validation:
      en: |
        This field must not be empty.
        This field must be either a number, "NA", or "ND"
        This value must not be negative.
      fr: |
        Ce champ ne doit pas être vide.
        Ce champ doit être un chiffre, "NA", ou "ND"
        Cette valeur ne doit être négative.
    occurrence: Single
    datastore_type: text
    excel_error_formula: 'OR({default_formula},IFERROR(VALUE({cell})<0,AND({cell}<>"NA",{cell}<>"ND")))'

  # DEP 1-40
  - datastore_id: num_applications_by_other
    label:
      en: Number of Applications Submitted via other channels
      fr: Nombre de demandes soumises par les autre modes de prestations
    description:
      en: >
        Identifies the number of applications received through other channels not
        listed in a fiscal year for the service. A value of 0 means no applications
        were received for this channel; ND means there is no data collected for this
        channel; and NA means no applications can be submitted through this channel.
      fr: >
        Indique le nombre de demandes reçues par des modes de prestations qui ne sont
        pas énumérés dans ce gabarit au cours d'un exercice. La valeur 0 signifie
        qu'aucune demande n'a été reçue via ce mode de prestation, aucune donnée (ND)
        signifie qu'aucune donnée n’est disponible, et sans objet (NA) signifie que le
        service n’est pas offert au moyen de ce mode de prestation.
    obligation: Mandatory
    excel_required: true
    form_required: true
    format_type: Free text
    validation:
      en: |
        This field must not be empty.
        This field must be either a number, "NA", or "ND"
        This value must not be negative.
      fr: |
        Ce champ ne doit pas être vide.
        Ce champ doit être un chiffre, "NA", ou "ND"
        Cette valeur ne doit être négative.
    occurrence: Single
    datastore_type: text
    excel_error_formula: 'OR({default_formula},IFERROR(VALUE({cell})<0,AND({cell}<>"NA",{cell}<>"ND")))'

  # DEP 1-45
  # Dev: Published Resource Field
  - datastore_id: num_applications_total
    label:
      en: Total Number of Applications
      fr: Nombre total de demandes soumises
    description:
      en: Identifies the total number of applications submitted in a fiscal year for all application channels.
      fr: Indique le nombre total de demandes reçues au cours d'un exercice pour tous les modes de prestation.
    obligation: Mandatory
    datastore_type: int
    published_resource_computed_field: true

  # DEP 1-41
  - datastore_id: special_remarks_en
    label:
      en: Special Remarks (English)
      fr: Remarques spéciales (anglais)
    description:
      en: >
        Provides additional space for comments related to volumetrics information.
        Please refer to associated Field ID, where applicable. For comments related
        to other fields, departments can create and publish an explanatory note on
        their website with a link to the GC Service Inventory dataset. This field is
        mandatory if there is an amount reported under “Number of applications
        submitted via other channels”
      fr: >
        Fournit de l'espace supplémentaire pour les commentaires relatifs aux
        renseignements sur les volumes. Veuillez vous reporter au code d'identification
        de la zone, s'il y a lieu. Pour les commentaires relatifs à d'autres zones,
        les ministères peuvent publier une note explicative sur leur site Web suivi
        d'un lien vers l'ensemble de données du Répertoire des services du GC.
        Ce champ est requis s’il y a un montant rapporté sous le champ « Nombre de
        demandes soumises par les autres modes de prestation »
    obligation:
      en: This field is mandatory if there is an amount reported under “Number of applications submitted via other channels”
      fr: Ce champ est requis s’il y a un montant rapporté sous le champ « Nombre de demandes soumises par les autres modes de prestation »
    excel_required: false
    excel_column_width: 80
    format_type: Free text
    validation:
      en: This field has a maximum length of 2000 characters.
      fr: Ce champ ne peut excéder une longueur maximale de 2000 caractères.
    occurrence: Single
    datastore_type: text
    max_chars: 2000
    excel_required_formula: 'OR(AND(NOT(ISBLANK({num_applications_by_other})),ISNUMBER(VALUE({num_applications_by_other})),VALUE({num_applications_by_other})>0),NOT(ISBLANK({special_remarks_fr})))'
    form_snippet: scheming/form_snippets/textarea.html
    form_attrs:
      maxlength: 2000

  # DEP 1-42
  - datastore_id: special_remarks_fr
    label:
      en: Special Remarks (French)
      fr: Remarques spéciales (français)
    description:
      en: >
        Provides additional space for comments related to volumetrics information.
        Please refer to associated Field ID, where applicable. For comments related
        to other fields, departments can create and publish an explanatory note on
        their website with a link to the GC Service Inventory dataset. This field is
        mandatory if there is an amount reported under “Number of applications
        submitted via other channels”
      fr: >
        Fournit de l'espace supplémentaire pour les commentaires relatifs aux
        renseignements sur les volumes. Veuillez vous reporter au code d'identification
        de la zone, s'il y a lieu. Pour les commentaires relatifs à d'autres zones,
        les ministères peuvent publier une note explicative sur leur site Web suivi
        d'un lien vers l'ensemble de données du Répertoire des services du GC.
        Ce champ est requis s’il y a un montant rapporté sous le champ « Nombre de
        demandes soumises par les autres modes de prestation »
    obligation:
      en: This field is mandatory if there is an amount reported under “Number of applications submitted via other channels”
      fr: Ce champ est requis s’il y a un montant rapporté sous le champ « Nombre de demandes soumises par les autres modes de prestation »
    excel_required: false
    excel_column_width: 80
    format_type: Free text
    validation:
      en: This field has a maximum length of 2000 characters.
      fr: Ce champ ne peut excéder une longueur maximale de 2000 caractères.
    occurrence: Single
    datastore_type: text
    max_chars: 2000
    excel_required_formula: 'OR(AND(NOT(ISBLANK({num_applications_by_other})),ISNUMBER(VALUE({num_applications_by_other})),VALUE({num_applications_by_other})>0),NOT(ISBLANK({special_remarks_en})))'
    form_snippet: scheming/form_snippets/textarea.html
    form_attrs:
      maxlength: 2000

  # DEP 1-43
  - datastore_id: service_uri_en
    label:
      en: URL to Service (English)
      fr: URL du service (anglais)
    description:
      en: Identifies the departmental webpage where the service is described and/or accessed.
      fr: Indique la page Web du ministère où le service est décrit et/ou peut être lancé.
    obligation: Optional
    excel_required: false
    format_type: Free text
    validation:
      en: This field has a maximum length of 1500 characters.
      fr: Ce champ ne peut excéder une longueur maximale de 1500 caractères.
    occurrence: Single
    datastore_type: text
    max_chars: 1500
    excel_required_formula: NOT(ISBLANK({service_uri_fr}))
    form_attrs:
      style: "width: 100%; display: block"
      maxlength: 1500

  # DEP 1-44
  - datastore_id: service_uri_fr
    label:
      en: URL to Service (French)
      fr: URL du service (français)
    description:
      en: Identifies the departmental webpage where the service is described and/or accessed.
      fr: Indique la page Web du ministère où le service est décrit et/ou peut être lancé.
    obligation: Optional
    excel_required: false
    format_type: Free text
    validation:
      en: This field has a maximum length of 1500 characters.
      fr: Ce champ ne peut excéder une longueur maximale de 1500 caractères.
    occurrence: Single
    datastore_type: text
    max_chars: 1500
    excel_required_formula: NOT(ISBLANK({service_uri_en}))
    form_attrs:
      style: "width: 100%; display: block"
      maxlength: 1500

  # Dev: req dynamic field
  - datastore_id: record_created
    label:
      en: Record Creation Time
      fr: Heure de la création du dossier
    import_template_include: false
    visible_to_public: false
    datastore_type: timestamp
    preview_class: bg-info

  # Dev: req dynamic field
  - datastore_id: record_modified
    label:
      en: Last Record Modification Time
      fr: Heure de la dernière modification au dossier
    import_template_include: false
    visible_to_public: false
    datastore_type: timestamp
    preview_class: bg-info

  # Dev: req dynamic field
  - datastore_id: user_modified
    label:
      en: User Last Modified Record
      fr: Dernier enregistrement modifié par l'utilisateur
    import_template_include: false
    visible_to_public: false
    datastore_type: text
    preview_class: bg-info

  # Dev: Published Resource Field
  - datastore_id: owner_org
    label:
      en: Department ID
      fr: ID du ministère
    description:
      en: Identifies the applied ID of the department or agency.
      fr: Identifie la ID d'usage du ministère ou de l'organisme.
    obligation: Mandatory
    datastore_type: text
    published_resource_computed_field: true

  # DEP 1-3
  # Dev: Published Resource Field
  - datastore_id: owner_org_title
    label:
      en: Department Name
      fr: Nom du ministère
    description:
      en: Identifies the applied title of the department or agency.
      fr: Identifie le titre d'usage du ministère ou de l'organisme.
    obligation: Mandatory
    datastore_type: text
    published_resource_computed_field: true

  datastore_primary_key: [fiscal_yr, service_id]
  datastore_indexes: ""
  datastore_constraint_error_templates:
    delete: recombinant/snippets/service_delete_fk_error.html
  datastore_constraint_errors:  # yaml | not supported
    delete: Cannot delete record(s) because the Fiscal Year, Service ID Number ({refValues}) is referenced in at least one Service Standards & Performance Results record.

  default_preview_sort: fiscal_yr, service_id

  triggers:
  - service_trigger: |
      DECLARE
        errors text[][] := '{{}}';
        crval RECORD;
      BEGIN
        errors := errors || required_error(NEW.fiscal_yr, 'fiscal_yr');
        errors := errors || choice_error(NEW.fiscal_yr, {fiscal_yr}, 'fiscal_yr');

        errors := errors || required_error(NEW.service_id, 'service_id');
        IF NEW.service_id LIKE '%,%' THEN
          errors := errors || ARRAY[['service_id', {service_id_comma_error}]];
        END IF;

        errors := errors || required_error(NEW.service_name_en, 'service_name_en');
        NEW.service_name_en := trim_lead_trailing(NEW.service_name_en);
        errors := errors || max_char_error(NEW.service_name_en, 350, 'service_name_en');

        errors := errors || required_error(NEW.service_name_fr, 'service_name_fr');
        NEW.service_name_fr := trim_lead_trailing(NEW.service_name_fr);
        errors := errors || max_char_error(NEW.service_name_fr, 350, 'service_name_fr');

        errors := errors || required_error(NEW.service_description_en, 'service_description_en');
        NEW.service_description_en := trim_lead_trailing(NEW.service_description_en);
        errors := errors || max_char_error(NEW.service_description_en, 1800, 'service_description_en');

        errors := errors || required_error(NEW.service_description_fr, 'service_description_fr');
        NEW.service_description_fr := trim_lead_trailing(NEW.service_description_fr);
        errors := errors || max_char_error(NEW.service_description_fr, 1800, 'service_description_fr');

        errors := errors || required_error(NEW.service_type, 'service_type');
        crval := choices_clean_error(NEW.service_type, {service_type}, 'service_type');
        errors := errors || crval.error;
        NEW.service_type := crval.clean;

        errors := errors || required_error(NEW.service_recipient_type, 'service_recipient_type');
        errors := errors || choice_error(NEW.service_recipient_type, {service_recipient_type}, 'service_recipient_type');

        errors := errors || required_error(NEW.service_scope, 'service_scope');
        crval := choices_clean_error(NEW.service_scope, {service_scope}, 'service_scope');
        errors := errors || crval.error;
        NEW.service_scope := crval.clean;

        errors := errors || required_error(NEW.client_target_groups, 'client_target_groups');
        crval := choices_clean_error(NEW.client_target_groups, {client_target_groups}, 'client_target_groups');
        errors := errors || crval.error;
        NEW.client_target_groups := crval.clean;

        errors := errors || required_error(NEW.program_id, 'program_id');
        crval := choices_clean_error(NEW.program_id, {program_id}, 'program_id');
        errors := errors || crval.error;
        NEW.program_id := crval.clean;

        errors := errors || required_error(NEW.client_feedback_channel, 'client_feedback_channel');
        crval := choices_clean_error(NEW.client_feedback_channel, {client_feedback_channel}, 'client_feedback_channel');
        errors := errors || crval.error;
        NEW.client_feedback_channel := crval.clean;

        errors := errors || required_error(NEW.automated_decision_system, 'automated_decision_system');
        errors := errors || choice_error(NEW.automated_decision_system, {automated_decision_system}, 'automated_decision_system');

        IF NEW.automated_decision_system = 'Y' THEN
          errors := errors || conditional_required_error(NEW.automated_decision_system_description_en, 'automated_decision_system_description_en');
          errors := errors || conditional_required_error(NEW.automated_decision_system_description_fr, 'automated_decision_system_description_fr');
        ELSE
          errors := errors || both_languages_error(NEW.automated_decision_system_description_en, 'automated_decision_system_description_en', NEW.automated_decision_system_description_fr, 'automated_decision_system_description_fr');
        END IF;

        NEW.automated_decision_system_description_en := trim_lead_trailing(NEW.automated_decision_system_description_en);
        errors := errors || max_char_error(NEW.automated_decision_system_description_en, 1800, 'automated_decision_system_description_en');

        NEW.automated_decision_system_description_fr := trim_lead_trailing(NEW.automated_decision_system_description_fr);
        errors := errors || max_char_error(NEW.automated_decision_system_description_fr, 1800, 'automated_decision_system_description_fr');

        errors := errors || required_error(NEW.service_fee, 'service_fee');
        errors := errors || choice_error(NEW.service_fee, {service_fee}, 'service_fee');

        errors := errors || required_error(NEW.os_account_registration, 'os_account_registration');
        errors := errors || choice_error(NEW.os_account_registration, {os_account_registration}, 'os_account_registration');

        errors := errors || required_error(NEW.os_authentication, 'os_authentication');
        errors := errors || choice_error(NEW.os_authentication, {os_authentication}, 'os_authentication');

        errors := errors || required_error(NEW.os_application, 'os_application');
        errors := errors || choice_error(NEW.os_application, {os_application}, 'os_application');

        errors := errors || required_error(NEW.os_decision, 'os_decision');
        errors := errors || choice_error(NEW.os_decision, {os_decision}, 'os_decision');

        errors := errors || required_error(NEW.os_issuance, 'os_issuance');
        errors := errors || choice_error(NEW.os_issuance, {os_issuance}, 'os_issuance');

        errors := errors || required_error(NEW.os_issue_resolution_feedback, 'os_issue_resolution_feedback');
        errors := errors || choice_error(NEW.os_issue_resolution_feedback, {os_issue_resolution_feedback}, 'os_issue_resolution_feedback');

        IF NEW.os_account_registration = 'NA' OR NEW.os_authentication = 'NA' OR NEW.os_application = 'NA' OR NEW.os_decision = 'NA' OR NEW.os_issuance = 'NA' OR NEW.os_issue_resolution_feedback = 'NA' THEN
          errors := errors || conditional_required_error(NEW.os_comments_client_interaction_en, 'os_comments_client_interaction_en');
          errors := errors || conditional_required_error(NEW.os_comments_client_interaction_fr, 'os_comments_client_interaction_fr');
        ELSE
          errors := errors || both_languages_error(NEW.os_comments_client_interaction_en, 'os_comments_client_interaction_en', NEW.os_comments_client_interaction_fr, 'os_comments_client_interaction_fr');
        END IF;

        NEW.os_comments_client_interaction_en := trim_lead_trailing(NEW.os_comments_client_interaction_en);
        errors := errors || max_char_error(NEW.os_comments_client_interaction_en, 1000, 'os_comments_client_interaction_en');

        NEW.os_comments_client_interaction_fr := trim_lead_trailing(NEW.os_comments_client_interaction_fr);
        errors := errors || max_char_error(NEW.os_comments_client_interaction_fr, 1000, 'os_comments_client_interaction_fr');

        errors := errors || choice_error(NEW.last_service_review, {last_service_review}, 'last_service_review');

        errors := errors || choice_error(NEW.last_service_improvement, {last_service_improvement}, 'last_service_improvement');

        errors := errors || required_error(NEW.sin_usage, 'sin_usage');
        errors := errors || choice_error(NEW.sin_usage, {sin_usage}, 'sin_usage');

        errors := errors || required_error(NEW.cra_bn_identifier_usage, 'cra_bn_identifier_usage');
        errors := errors || choice_error(NEW.cra_bn_identifier_usage, {cra_bn_identifier_usage}, 'cra_bn_identifier_usage');

        errors := errors || required_error(NEW.num_phone_enquiries, 'num_phone_enquiries');
        NEW.num_phone_enquiries := UPPER(NEW.num_phone_enquiries);
        errors := errors || int_na_nd_error(NEW.num_phone_enquiries, 'num_phone_enquiries');

        errors := errors || required_error(NEW.num_applications_by_phone, 'num_applications_by_phone');
        NEW.num_applications_by_phone := UPPER(NEW.num_applications_by_phone);
        errors := errors || int_na_nd_error(NEW.num_applications_by_phone, 'num_applications_by_phone');

        errors := errors || required_error(NEW.num_website_visits, 'num_website_visits');
        NEW.num_website_visits := UPPER(NEW.num_website_visits);
        errors := errors || int_na_nd_error(NEW.num_website_visits, 'num_website_visits');

        errors := errors || required_error(NEW.num_applications_online, 'num_applications_online');
        NEW.num_applications_online := UPPER(NEW.num_applications_online);
        errors := errors || int_na_nd_error(NEW.num_applications_online, 'num_applications_online');

        errors := errors || required_error(NEW.num_applications_in_person, 'num_applications_in_person');
        NEW.num_applications_in_person := UPPER(NEW.num_applications_in_person);
        errors := errors || int_na_nd_error(NEW.num_applications_in_person, 'num_applications_in_person');

        errors := errors || required_error(NEW.num_applications_by_mail, 'num_applications_by_mail');
        NEW.num_applications_by_mail := UPPER(NEW.num_applications_by_mail);
        errors := errors || int_na_nd_error(NEW.num_applications_by_mail, 'num_applications_by_mail');

        errors := errors || required_error(NEW.num_applications_by_email, 'num_applications_by_email');
        NEW.num_applications_by_email := UPPER(NEW.num_applications_by_email);
        errors := errors || int_na_nd_error(NEW.num_applications_by_email, 'num_applications_by_email');

        errors := errors || required_error(NEW.num_applications_by_fax, 'num_applications_by_fax');
        NEW.num_applications_by_fax := UPPER(NEW.num_applications_by_fax);
        errors := errors || int_na_nd_error(NEW.num_applications_by_fax, 'num_applications_by_fax');

        errors := errors || required_error(NEW.num_applications_by_other, 'num_applications_by_other');
        NEW.num_applications_by_other := UPPER(NEW.num_applications_by_other);
        errors := errors || int_na_nd_error(NEW.num_applications_by_other, 'num_applications_by_other');

        IF NEW.num_applications_by_other != 'NA' AND NEW.num_applications_by_other != 'ND' AND NEW.num_applications_by_other ~ '^-?[0-9]+$' AND NEW.num_applications_by_other::int > 0 THEN
          errors := errors || required_error(NEW.special_remarks_en, 'special_remarks_en');
          errors := errors || required_error(NEW.special_remarks_fr, 'special_remarks_fr');
        END IF;

        NEW.special_remarks_en := trim_lead_trailing(NEW.special_remarks_en);
        errors := errors ||  max_char_error(NEW.special_remarks_en, 2000, 'special_remarks_en');

        NEW.special_remarks_fr := trim_lead_trailing(NEW.special_remarks_fr);
        errors := errors || max_char_error(NEW.special_remarks_fr, 2000, 'special_remarks_fr');

        errors := errors || both_languages_error(NEW.special_remarks_en, 'special_remarks_en', NEW.special_remarks_fr, 'special_remarks_fr');

        NEW.service_uri_en := trim_lead_trailing(NEW.service_uri_en);
        errors := errors || max_char_error(NEW.service_uri_en, 1500, 'service_uri_en');

        NEW.service_uri_fr := trim_lead_trailing(NEW.service_uri_fr);
        errors := errors || max_char_error(NEW.service_uri_fr, 1500, 'service_uri_fr');

        errors := errors || both_languages_error(NEW.service_uri_en, 'service_uri_en', NEW.service_uri_fr, 'service_uri_fr');

        IF errors = '{{}}' THEN
          RETURN NEW;
        END IF;

        RAISE EXCEPTION E'TAB-DELIMITED\t%', array_to_string(errors, E'\t');
      END;
  - update_record_modified_created_trigger

  trigger_strings:  # yaml | not supported
    num_na_nd_error: This field must be either a number, "NA", or "ND"
    negative_number_error: This value must not be negative
    max_length_error: This field has a maximum length of {} characters.
    invalid_choice_error: 'Invalid choice: {}'
    integer_type_error: 'Invalid input syntax for type integer: {}'
    conditional_required_error: This field is required due to a response in a different field.
    both_lang_error: This text must be provided in both languages
    service_id_comma_error: Comma is not allowed in Service ID Number field

  examples:
    record:
      fiscal_yr: 2022-2023
      service_id: '1001'
      service_name_en: Old Age Security (OAS) Benefits
      service_name_fr: Prestations de la Sécurité de la vieillesse
      service_description_en: >
        The Old Age Security (OAS) pension is a monthly payment available to most Canadians 65 years
        of age who meet the Canadian legal status and residence requirements. In addition to the Old
        Age Security pension, there are three types of Old Age Security benefits:  the Guaranteed
        Income Supplement, Allowance and Allowance for the Survivor. The OAS provides financial
        support to millions of seniors, including those that are low-income, each year.
      service_description_fr: >
        La pension de la Sécurité de la vieillesse (SV) est une prestation mensuelle versée à la
        plupart des Canadiens âgés de 65 ans et plus qui satisfont aux exigences relatives au statut
        juridique et à la résidence au Canada. En plus de la pension de la Sécurité de la vieillesse,
        il existe trois types de prestations de la Sécurité de la vieillesse : le Supplément de revenu
        garanti, l'Allocation et l'Allocation au survivant. La SV verse chaque année un soutien
        financier à des millions d'aînés, incluant ceux à faible revenu.
      service_type: [RES]
      service_recipient_type: CLIENT
      service_scope: [EXTERN]
      client_target_groups: [PERSON]
      program_id: [BGN01]
      client_feedback_channel: [EML, FAX, PERSON, ONL, POST, TEL]
      automated_decision_system: 'N'
      automated_decision_system_description_en: ''
      automated_decision_system_description_fr: ''
      service_fee: 'N'
      os_account_registration: 'Y'
      os_authentication: 'Y'
      os_application: 'Y'
      os_decision: 'Y'
      os_issuance: 'Y'
      os_issue_resolution_feedback: 'Y'
      os_comments_client_interaction_en: ''
      os_comments_client_interaction_fr: ''
      last_service_review: ''
      last_service_improvement: 2021-2022
      sin_usage: 'Y'
      cra_bn_identifier_usage: 'Y'
      num_phone_enquiries: 7252346
      num_applications_by_phone: 0
      num_website_visits: 5446484
      num_applications_online: 276390
      num_applications_in_person: 0
      num_applications_by_mail: 792026
      num_applications_by_email: 0
      num_applications_by_fax: 0
      num_applications_by_other: 2218002
      special_remarks_en: |
        - The volume reflected in the 'Applications by Mail' column include the volume of paper applications for the following OAS pension benefits application types: OAS basic pension; the Guaranteed Income Supplement (GIS); Allowance; Allowance Survivor; Renewal of GIS/Allowance/Allowance Survivor; Options for GIS/Allowance/Allowance Survivor; and foreign benefits.
        - The volume reflected in the 'Number of Automatic Enrolments' column represents the volume of Automatic Enrolment into the OAS basic pension and the GIS.
        - The volume reflected in the 'Applications through Other Channels' column represents the volume of the Automatic Renewal of income-tested benefits through the CRA for the GIS.
        - Applications to OAS pension benefits do not constitute the largest volume of work done by the OAS program. In addition to applications, there were also another 3,143,898 OAS and foreign benefit account revisions in 2022-2023.
        - OAS and CPP telephone enquiries are managed through the same Pensions Toll-free service, with significant overlap between the two programs on many calls. The metrics reported for CPP and OAS,  such as the volume of calls, are therefore identical and are non-cumulative (i.e. they are not to be added together)."
      special_remarks_fr: |
        - Le volume indiqué dans la colonne « Demandes par la poste » comprend le volume de demandes papier pour les types de demandes de prestations de pension de la SV suivants : pension de base de la SV ; le Supplément de revenu garanti (SRG); Allocation ; Allocation de survivant ; Renouvellement du SRG/Allocation/ Allocation de survivant ; options pour le SRG/l'allocation/l'allocation de survivant ; et les prestations étrangères.
        - Le volume indiqué dans la colonne ""Nombre d'inscriptions automatiques"" représente le volume des inscriptions automatiques à la pension de base de la SV et au SRG.
        - Le volume reflété dans la colonne « Demandes par d'autres canaux » représente le volume d'adhésion automatique à la pension de base de la SV et du SRG, ainsi que le renouvellement automatique des prestations fondées sur le revenu par l'intermédiaire de l'ARC pour le SRG.
        - Les demandes de prestations de pension de la SV ne constituent pas le plus gros volume de travail effectué par le programme de la SV. En plus des demandes, il y a eu également 3 143 898 autres révisions des comptes de SV et de prestations étrangères en 2022-2023
        - Les demandes de renseignements téléphoniques sur la SV et le RPC sont gérées par le même service téléphonique sans frais des pensions, avec un chevauchement important entre les deux programmes pour de nombreux appels. Les mesures rapportées pour le RPC et la SV, comme le volume d'appels, sont donc identiques et non cumulatives (c'est-à-dire qu'elles ne doivent pas être additionnées). "
      service_uri_en: https://www.canada.ca/en/services/benefits/publicpensions/cpp/old-age-security.html
      service_uri_fr: https://www.canada.ca/fr/services/prestations/pensionspubliques/rpc/securite-vieillesse.html
    filters:
      client_target_groups: PERSON
    filter_one:
      fiscal_yr: 2022-2023
      sin_usage: 'Y'
    sort: year, service_id


- title: Service Standards & Performance Results
  resource_name: service-std

  published_resource_id: 8736cd7e-9bf9-4a45-9eee-a6cb3c43c07e

  create_form: true
  edit_form: true

  fields:

  # DEP 2-1
  - datastore_id: fiscal_yr
    label:
      en: Fiscal Year
      fr: Année financière
    description:
      en: >
        Identifies the fiscal year (April 1 to March 31) during which service activities took place.
        For example, records for fiscal year 2023-2024 should include applications received
        from April 1, 2023, to March 31, 2024.
      fr: >
        Indique l'exercice financier (1 avril au 31 mars) durant lequel les activités du service ont eu lieu.
        Par exemple, les données pour l’exercice financier 2023-2024 devrait inclure les demandes de service qui
        ont été reçues entre le 1 avril 2023 et le 31 mars 2024.
    obligation: Mandatory
    excel_required: true
    form_required: true
    validation:
      en: This field must not be empty.
      fr: Ce champ ne doit pas être vide.
    occurrence: Single
    datastore_type: text
    excel_full_text_choices: false
    choices_file: choices/fiscal_year.yaml

  # DEP 2-2
  - datastore_id: service_id
    label:
      en: Service ID Number
      fr: Numéro d'identification du service
    description:
      en: The unique number assigned to a service in the inventory to make it easier to refer to specific services.
      fr: Le numéro unique attribué à un service dans le répertoire afin de faciliter le référencement à des services précis.
    obligation: Mandatory
    excel_required: true
    form_required: true
    excel_error_formula: 'OR({default_formula},LEN({cell})-LEN(SUBSTITUTE({cell},",",""))>0)'
    validation:
      en: |
        This field must not be empty.
        This field cannot contain commas.
      fr: |
        Ce champ ne doit pas être vide.
        Ce champ ne peut pas contenir de virgules.
    format_type: Free text
    occurrence: Single
    datastore_type: text

  # DEP 2-3
  - datastore_id: service_name_en
    label:
      en: Service Name (English)
      fr: Nom du service (en anglais)
    description:
      en: Identifies the official name of the service.
      fr: Indique le nom officiel du service.
    obligation: Mandatory
    excel_required: true
    excel_column_width: 40
    form_required: true
    validation:
      en: |
        This field must not be empty.
        This field has a maximum length of 350 characters.
      fr: |
        Ce champ ne doit pas être vide.
        Ce champ ne peut excéder une longueur maximale de 350 caractères.
    format_type: Free text
    occurrence: Single
    datastore_type: text
    max_chars: 350
    form_attrs:
      style: "width: 100%; display: block"
      maxlength: 350

  # DEP 2-4
  - datastore_id: service_name_fr
    label:
      en: Service Name (French)
      fr: Nom du service (en français)
    description:
      en: Identifies the official name of the service.
      fr: Indique le nom officiel du service.
    obligation: Mandatory
    excel_required: true
    excel_column_width: 40
    form_required: true
    validation:
      en: |
        This field must not be empty.
        This field has a maximum length of 350 characters.
      fr: |
        Ce champ ne doit pas être vide.
        Ce champ ne peut excéder une longueur maximale de 350 caractères.
    format_type: Free text
    occurrence: Single
    datastore_type: text
    max_chars: 350
    form_attrs:
      style: "width: 100%; display: block"
      maxlength: 350

  # DEP 2-5
  - datastore_id: service_standard_id
    label:
      en: Service Standard ID
      fr: Numéro d'identification de la norme relative aux services
    description:
      en: >
        Identifies the unique number assigned to each service standard for that
        service. Makes it easier for reference purposes as one service may have
        multiple standards.
      fr: >
        Indique le numéro unique attribué à chaque norme relative aux services
        pour ce service. Facilite le référencement, car un service peut avoir
        de multiples normes.
    obligation: Mandatory
    excel_required: true
    form_required: true
    excel_error_formula: 'OR({default_formula},LEN({cell})-LEN(SUBSTITUTE({cell},",",""))>0)'
    validation:
      en: |
        This field must not be empty.
        This field cannot contain commas.
      fr: |
        Ce champ ne doit pas être vide.
        Ce champ ne peut pas contenir de virgules.
    format_type: Free text
    occurrence: Single
    datastore_type: text

  # DEP 2-6
  - datastore_id: service_standard_en
    label:
      en: Service Standard (English)
      fr: Norme relative aux services (anglais)
    description:
      en: >
        Identifies the service standard related to a particular service. See
        Guideline on Service and Digital for format to be used when defining
        service standards.
      fr: >
        Indique la norme relative aux services ayant trait à un service en
        particulier. Voir la Ligne directrice sur les services et le numérique
        afin de connaître le format à utiliser pour définir les normes relatives
        aux services.
    obligation: Mandatory
    excel_required: true
    excel_column_width: 60
    form_required: true
    validation:
      en: |
        This field must not be empty.
        This field has a maximum length of 500 characters.
      fr: |
        Ce champ ne doit pas être vide.
        Ce champ ne peut excéder une longueur maximale de 500 caractères.
    format_type: Free text
    occurrence: Single
    datastore_type: text
    max_chars: 500
    form_snippet: scheming/form_snippets/textarea.html
    form_attrs:
      maxlength: 500

  # DEP 2-7
  - datastore_id: service_standard_fr
    label:
      en: Service Standard (French)
      fr: Norme relative aux services (français)
    description:
      en: >
        Identifies the service standard related to a particular service. See
        Guideline on Service and Digital for format to be used when defining
        service standards.
      fr: >
        Indique la norme relative aux services ayant trait à un service en
        particulier. Voir la Ligne directrice sur les services et le numérique
        afin de connaître le format à utiliser pour définir les normes relatives
        aux services.
    obligation: Mandatory
    excel_required: true
    excel_column_width: 60
    form_required: true
    validation:
      en: |
        This field must not be empty.
        This field has a maximum length of 500 characters.
      fr: |
        Ce champ ne doit pas être vide.
        Ce champ ne peut excéder une longueur maximale de 500 caractères.
    format_type: Free text
    occurrence: Single
    datastore_type: text
    max_chars: 500
    form_snippet: scheming/form_snippets/textarea.html
    form_attrs:
      maxlength: 500

  # DEP 2-8
  - datastore_id: type
    label:
      en: Service Standard Type
      fr: Type de norme relative aux services
    description:
      en: >
        Identifies the type of service standard as defined in the Guideline on Service
        and Digital. Access: a commitment outlining the ease and convenience the client
        should experience when attempting to access a service. Accuracy: a commitment
        stipulating that the client will receive a service that is up to date, free of
        errors, and complete. Timeliness: a commitment stating how long the client should
        expect to wait to receive a service once the service has been accessed.
      fr: >
        Indique le type de norme relative aux services défini dans la Ligne directrice
        sur les services et le numérique. Accès: un engagement qui décrit la facilité
        et la convivialité que devrait connaître le client lorsqu'il essaie d'accéder
        à un service. Exactitude: un engagement qui stipule que le client recevra un
        service complet et à jour qui est exempt d'erreurs. Délai: un engagement qui
        indique le temps d'attente que devrait connaître le client pour recevoir un
        service une fois qu'il y a accédé.
    obligation: Mandatory
    excel_required: true
    form_required: true
    format_type: Controlled List
    validation:
      en: This field must not be empty.
      fr: Ce champ ne doit pas être vide.
    occurrence: Single
    datastore_type: text
    excel_full_text_choices: true
    choices:
      ACS:
        en: Access
        fr: Accès
      ACY:
        en: Accuracy
        fr: Exactitude
      OTH:
        en: Other
        fr: Autre
      TML:
        en: Timeliness
        fr: Délai

  # DEP 2-9
  - datastore_id: channel
    label:
      en: Service Standard Channel
      fr: Mode de prestation de la norme de service
    description:
      en: Identifies the service channel to which the service standard applies
      fr: Identifie à quelle mode de prestation de service la norme de service s'applique
    obligation: Mandatory
    excel_required: true
    form_required: true
    format_type: Controlled List
    validation:
      en: This field must not be empty.
      fr: Ce champ ne doit pas être vide.
    occurrence: Single
    datastore_type: text
    excel_full_text_choices: true
    choices:
      EML:
        en: Email
        fr: Courriel
      FAX:
        en: Fax
        fr: Télécopieur
      ONL:
        en: Online
        fr: En ligne
      OTH:
        en: Other channel not listed
        fr: Autre option qui n’est pas sur la liste
      PERSON:
        en: In-Person
        fr: En personne
      POST:
        en: Postal Mail
        fr: Courrier postal
      TEL:
        en: Telephone
        fr: Téléphone

  # DEP 2-10
  - datastore_id: channel_comments_en
    label:
      en: Comments on the service standard channel (English)
      fr: Commentaires sur le mode de prestation de la norme de service (anglais)
    description:
      en: Comments related to the service standard channel and provides explanation of "Other" channel selection.
      fr: Commentaires en lien au mode de prestation de la norme de service et fournit une explication de la sélection des modes de prestation « Autre ».
    obligation: Optional
    excel_required: false
    excel_column_width: 80
    format_type: Free text
    validation:
      en: This field has a maximum length of 1500 characters.
      fr: Ce champ ne peut excéder une longueur maximale de 1500 caractères.
    occurrence: Single
    datastore_type: text
    max_chars: 1500
    excel_required_formula: NOT(ISBLANK({channel_comments_fr}))
    form_snippet: scheming/form_snippets/textarea.html
    form_attrs:
      maxlength: 1500

  # DEP 2-11
  - datastore_id: channel_comments_fr
    label:
      en: Comments on the service standard channel (French)
      fr: Commentaires sur le mode de prestation de la norme de service (Francais)
    description:
      en: Comments related to the service standard channel and provides explanation of "Other" channel selection.
      fr: Commentaires en lien au mode de prestation de la norme de service et fournit une explication de la sélection des modes de prestation « Autre ».
    obligation: Optional
    excel_required: false
    excel_column_width: 80
    format_type: Free text
    validation:
      en: This field has a maximum length of 1500 characters.
      fr: Ce champ ne peut excéder une longueur maximale de 1500 caractères.
    occurrence: Single
    datastore_type: text
    max_chars: 1500
    excel_required_formula: NOT(ISBLANK({channel_comments_en}))
    form_snippet: scheming/form_snippets/textarea.html
    form_attrs:
      maxlength: 1500

  # DEP 2-12
  - datastore_id: target
    label:
      en: Service Standard Target
      fr: Cible de la norme relative aux services
    description:
      en: The frequency that the organization expects to meet service standard (reported as a percentage).
      fr: Fréquence à laquelle l'organisation s'attend à respecter sa norme de service (exprimée en pourcentage).
    obligation: Optional
    excel_required: false
    format_type: Decimal
    validation:
      en: This field must be a single number between 0 and 1 representing a percentage.
      fr: Ce champ doit inscrire un seul et unique chiffre entre 0 et 1 représentant un pourcentage.
    occurrence: Single
    datastore_type: numeric
    excel_error_formula: 'OR({default_formula},{cell}<0,{cell}>1)'

  # DEP 2-13
  - datastore_id: volume_meeting_target
    label:
      en: Business Volume That Met Service Standard Target
      fr: Volume d'activités qui respectent la cible de la norme relative aux services
    description:
      en: >
        Identifies the number of final outputs issued appropriate to the service
        (eg. payments issued, requests completed, etc) during the fiscal year that met
        a particular service standard target for a service. Blank indicates no information
        available, while 0 indicates that no final outputs issued met service standard targets.
      fr: >
        Indique le nombre d'opérations de service effectuées (p. ex. les appels auxquels on a
        répondu, les paiements émis, les demandes traitées, etc.) au cours de l'exercice qui
        ont respecté une norme relative aux services particulière à un service. Un champ vide
        indique qu'aucune information n'est disponible, tandis que 0 indique qu'aucun résultat
        final n'a été émis qui a atteint les objectifs de la norme de service.
    obligation: Optional
    excel_required: false
    format_type: Decimal
    validation:
      en: |
        This value must not be negative.
        Volume Meeting Target can not exceed Total Volume.
      fr: |
        Cette valeur ne doit être négative.
        Les volumes atteignant la cible ne peuvent pas dépasser le volume total.
    occurrence: Single
    datastore_type: bigint
    excel_error_formula: 'OR({default_formula},NOT(ISNUMBER({cell})),{cell}<0)'

  # DEP 2-14
  - datastore_id: total_volume
    label:
      en: Total Volume
      fr: Volumes totaux
    description:
      en: >
        Identifies the total number of final outputs issued appropriate to the service
        (eg. payments issued, requests completed, etc) during the fiscal year. Blank
        indicates no information available, while 0 indicates no final outputs issued.
      fr: >
        Indique le nombre total d'opérations de service effectuées (p. ex. les paiements
        émis, les demandes traitées, etc.) relativement à un service au cours de l'exercice.
        Un champ vide indique qu'aucune information n'est disponible, tandis que 0 indique
        qu'aucune opération n'a été effectuée.
    obligation: Optional
    excel_required: false
    format_type: Decimal
    validation:
      en: This value must not be negative.
      fr: Cette valeur ne doit être négative.
    occurrence: Single
    datastore_type: bigint
    excel_error_formula: 'OR({default_formula},NOT(ISNUMBER({cell})),{cell}<0,OFFSET({cell},-1,0)>{cell})'

  # DEP 2-15
  # Dev: Published Resource Field
  - datastore_id: performance
    label:
      en: Performance
      fr: Performance
    description:
      en: >
        Identifies the result achieved for this service standard. This is the "Business Volume That Met Service Standard Target"
        divided by the "Total Volume".
      fr: >
        Identifie les résultats atteints pour cette norme de service. Il s'agit du "Volume d'activités qui respectent la cible
        de la norme relative aux services" divisé par le "Volumes totaux".
    obligation: Optional
    datastore_type: numeric
    published_resource_computed_field: true

  # DEP 2-16
  - datastore_id: comments_en
    label:
      en: Comments on the service standard in general (English)
      fr: Commentaires sur la norme de service en general (anglais)
    description:
      en: Comments related to the service standard in general.
      fr: Commentaires en lien à la norme de service en general.
    obligation: Optional
    excel_required: false
    excel_column_width: 80
    format_type: Free text
    validation:
      en: This field has a maximum length of 2000 characters.
      fr: Ce champ ne peut excéder une longueur maximale de 2000 caractères.
    occurrence: Single
    datastore_type: text
    max_chars: 2000
    excel_required_formula: NOT(ISBLANK({comments_fr}))
    form_snippet: scheming/form_snippets/textarea.html
    form_attrs:
      maxlength: 2000

  # DEP 2-17
  - datastore_id: comments_fr
    label:
      en: Comments on the service standard in general (French)
      fr: Commentaires sur la norme de service en general (Francais)
    description:
      en: Comments related to the service standard in general.
      fr: Commentaires en lien à la norme de service en general.
    obligation: Optional
    excel_required: false
    excel_column_width: 80
    format_type: Free text
    validation:
      en: This field has a maximum length of 2000 characters.
      fr: Ce champ ne peut excéder une longueur maximale de 2000 caractères.
    occurrence: Single
    datastore_type: text
    max_chars: 2000
    excel_required_formula: NOT(ISBLANK({comments_en}))
    form_snippet: scheming/form_snippets/textarea.html
    form_attrs:
      maxlength: 2000

  # DEP 2-18
  # Dev: Published Resource Field
  - datastore_id: target_met
    label:
      en: Was the target met
      fr: La cible était-elle atteinte
    # description:
      #TODO: get a description
      # en:
      # fr:
    obligation: Mandatory
    datastore_type: text
    published_resource_computed_field: true
    choices:
      'NA':
        en: N/A
        fr: S.O.
      'N':
        en: "No"
        fr: Non
      'Y':
        en: "Yes"
        fr: Oui

  # DEP 2-19
  - datastore_id: standards_targets_uri_en
    label:
      en: URL to Service Standards and Targets (English)
      fr: URL vers les normes relatives aux services et les cibles (anglais)
    description:
      en: Identifies the departmental webpage (Canada.ca) where the service standards and targets are published.
      fr: Indique la page Web ministérielle (Canada.ca) où les normes relatives aux services et les cibles sont publiées.
    obligation: Mandatory
    excel_required: true
    form_required: true
    format_type: Free text
    validation:
      en: |
        This field must not be empty.
        This field has a maximum length of 1500 characters.
      fr: |
        Ce champ ne doit pas être vide.
        Ce champ ne peut excéder une longueur maximale de 1500 caractères.
    occurrence: Single
    datastore_type: text
    max_chars: 1500
    form_attrs:
      style: "width: 100%; display: block"
      maxlength: 1500

  # DEP 2-20
  - datastore_id: standards_targets_uri_fr
    label:
      en: URL to Service Standards and Targets (French)
      fr: URL vers les normes relatives aux services et les cibles (français)
    description:
      en: Identifies the departmental webpage (Canada.ca) where the service standards and targets are published.
      fr: Indique la page Web ministérielle (Canada.ca) où les normes relatives aux services et les cibles sont publiées.
    obligation: Mandatory
    excel_required: true
    form_required: true
    format_type: Free text
    validation:
      en: |
        This field must not be empty.
        This field has a maximum length of 1500 characters.
      fr: |
        Ce champ ne doit pas être vide.
        Ce champ ne peut excéder une longueur maximale de 1500 caractères.
    occurrence: Single
    datastore_type: text
    max_chars: 1500
    form_attrs:
      style: "width: 100%; display: block"
      maxlength: 1500

  # DEP 2-21
  - datastore_id: performance_results_uri_en
    label:
      en: URL to Real-Time Performance Results (English)
      fr: URL aux résultats de rendement en temps réel (anglais)
    description:
      en: Identifies the departmental webpage where the real-time performance results for a service are published.
      fr: Identifie la site Web du service sur laquelle les résultats de performance en temps réel d'un service sont publiés.
    obligation: Optional
    excel_required: false
    format_type: Free text
    validation:
      en: This field has a maximum length of 1500 characters.
      fr: Ce champ ne peut excéder une longueur maximale de 1500 caractères.
    occurrence: Single
    datastore_type: text
    max_chars: 1500
    excel_required_formula: NOT(ISBLANK({performance_results_uri_fr}))
    form_attrs:
      style: "width: 100%; display: block"
      maxlength: 1500

  # DEP 2-22
  - datastore_id: performance_results_uri_fr
    label:
      en: URL to Real-Time Performance Results (French)
      fr: URL aux résultats de rendement en temps réel (français)
    description:
      en: Identifies the departmental webpage where the real-time performance results for a service are published.
      fr: Identifie la site Web du service sur laquelle les résultats de performance en temps réel d'un service sont publiés.
    obligation: Optional
    excel_required: false
    format_type: Free text
    validation:
      en: This field has a maximum length of 1500 characters.
      fr: Ce champ ne peut excéder une longueur maximale de 1500 caractères.
    occurrence: Single
    datastore_type: text
    max_chars: 1500
    excel_required_formula: NOT(ISBLANK({performance_results_uri_en}))
    form_attrs:
      style: "width: 100%; display: block"
      maxlength: 1500

  # Dev: req dynamic field
  - datastore_id: record_created
    label:
      en: Record Creation Time
      fr: Heure de la création du dossier
    import_template_include: false
    visible_to_public: false
    datastore_type: timestamp
    preview_class: bg-info

  # Dev: req dynamic field
  - datastore_id: record_modified
    label:
      en: Last Record Modification Time
      fr: Heure de la dernière modification au dossier
    import_template_include: false
    visible_to_public: false
    datastore_type: timestamp
    preview_class: bg-info

  # Dev: req dynamic field
  - datastore_id: user_modified
    label:
      en: User Last Modified Record
      fr: Dernier enregistrement modifié par l'utilisateur
    import_template_include: false
    visible_to_public: false
    datastore_type: text
    preview_class: bg-info

  # Dev: Published Resource Field
  - datastore_id: owner_org
    label:
      en: Department ID
      fr: ID du ministère
    description:
      en: Identifies the applied ID of the department or agency.
      fr: Identifie la ID d'usage du ministère ou de l'organisme.
    obligation: Mandatory
    datastore_type: text
    published_resource_computed_field: true

  # DEP 2-24
  # Dev: Published Resource Field
  - datastore_id: owner_org_title
    label:
      en: Department Name
      fr: Nom du ministère
    description:
      en: Identifies the applied title of the department or agency.
      fr: Identifie le titre d'usage du ministère ou de l'organisme.
    obligation: Mandatory
    datastore_type: text
    published_resource_computed_field: true

  datastore_primary_key: [fiscal_yr, service_id, service_standard_id]
  datastore_reference_table_only: true
  datastore_foreign_keys:
    service:
      fiscal_yr: fiscal_yr
      service_id: service_id
  datastore_indexes: ""
  datastore_constraint_error_templates:
    upsert: recombinant/snippets/service_std_upsert_fk_error.html
  datastore_constraint_errors:  # yaml | not supported
    upsert: Cannot create record ({refValues}) because the Service ID Number does not exist in the Service Identification Information & Metrics resource for that fiscal year.

  default_preview_sort: fiscal_yr, service_id, service_standard_id

  triggers:
  - service_std_trigger: |
      DECLARE
        errors text[][] := '{{}}';
        crval RECORD;
      BEGIN
        errors := errors || required_error(NEW.fiscal_yr, 'fiscal_yr');
        errors := errors || choice_error(NEW.fiscal_yr, {fiscal_yr}, 'fiscal_yr');

        errors := errors || required_error(NEW.service_id, 'service_id');
        IF NEW.service_id LIKE '%,%' THEN
          errors := errors || ARRAY[['service_id', {service_id_comma_error}]];
        END IF;

        errors := errors || required_error(NEW.service_name_en, 'service_name_en');
        NEW.service_name_en := trim_lead_trailing(NEW.service_name_en);
        errors := errors || max_char_error(NEW.service_name_en, 350, 'service_name_en');

        errors := errors || required_error(NEW.service_name_fr, 'service_name_fr');
        NEW.service_name_fr := trim_lead_trailing(NEW.service_name_fr);
        errors := errors || max_char_error(NEW.service_name_fr, 350, 'service_name_fr');

        errors := errors || required_error(NEW.service_standard_id, 'service_standard_id');
        IF NEW.service_standard_id LIKE '%,%' THEN
          errors := errors || ARRAY[['service_standard_id', {service_standard_id_comma_error}]];
        END IF;

        errors := errors || required_error(NEW.service_standard_en, 'service_standard_en');
        NEW.service_standard_en := trim_lead_trailing(NEW.service_standard_en);
        errors := errors || max_char_error(NEW.service_standard_en, 500, 'service_standard_en');

        errors := errors || required_error(NEW.service_standard_fr, 'service_standard_fr');
        NEW.service_standard_fr := trim_lead_trailing(NEW.service_standard_fr);
        errors := errors || max_char_error(NEW.service_standard_fr, 500, 'service_standard_fr');

        errors := errors || required_error(NEW.type, 'type');
        errors := errors || choice_error(NEW.type, {type}, 'type');

        errors := errors || required_error(NEW.channel, 'channel');
        errors := errors || choice_error(NEW.channel, {channel}, 'channel');

        NEW.channel_comments_en := trim_lead_trailing(NEW.channel_comments_en);
        errors := errors || max_char_error(NEW.channel_comments_en, 1500, 'channel_comments_en');

        NEW.channel_comments_fr := trim_lead_trailing(NEW.channel_comments_fr);
        errors := errors || max_char_error(NEW.channel_comments_fr, 1500, 'channel_comments_fr');

        errors := errors || both_languages_error(NEW.channel_comments_en, 'channel_comments_en', NEW.channel_comments_fr, 'channel_comments_fr');

        IF NEW.target IS NOT NULL AND (NEW.target < 0 OR NEW.target > 1) THEN
            errors := errors || ARRAY[['target', {target_error}]];
        END IF;

        IF NEW.volume_meeting_target IS NOT NULL AND NEW.volume_meeting_target < 0 THEN
            errors := errors || ARRAY[['volume_meeting_target', {negative_number_error}]];
        END IF;

        IF NEW.total_volume IS NOT NULL AND NEW.total_volume < 0 THEN
            errors := errors || ARRAY[['total_volume', {negative_number_error}]];
        END IF;

        IF NEW.volume_meeting_target > NEW.total_volume THEN
            errors := errors || ARRAY[['volume_meeting_target', {volume_error}]];
        END IF;

        NEW.comments_en := trim_lead_trailing(NEW.comments_en);
        errors := errors || max_char_error(NEW.comments_en, 2000, 'comments_en');

        NEW.comments_fr := trim_lead_trailing(NEW.comments_fr);
        errors := errors || max_char_error(NEW.comments_fr, 2000, 'comments_fr');

        errors := errors || both_languages_error(NEW.comments_en, 'comments_en', NEW.comments_fr, 'comments_fr');

        errors := errors || required_error(NEW.standards_targets_uri_en, 'standards_targets_uri_en');
        NEW.standards_targets_uri_en := trim_lead_trailing(NEW.standards_targets_uri_en);
        errors := errors || max_char_error(NEW.standards_targets_uri_en, 1500, 'standards_targets_uri_en');

        errors := errors || required_error(NEW.standards_targets_uri_fr, 'standards_targets_uri_fr');
        NEW.standards_targets_uri_fr := trim_lead_trailing(NEW.standards_targets_uri_fr);
        errors := errors || max_char_error(NEW.standards_targets_uri_fr, 1500, 'standards_targets_uri_fr');

        NEW.performance_results_uri_en := trim_lead_trailing(NEW.performance_results_uri_en);
        errors := errors || max_char_error(NEW.performance_results_uri_en, 1500, 'performance_results_uri_en');

        NEW.performance_results_uri_fr := trim_lead_trailing(NEW.performance_results_uri_fr);
        errors := errors || max_char_error(NEW.performance_results_uri_fr, 1500, 'performance_results_uri_fr');

        errors := errors || both_languages_error(NEW.performance_results_uri_en, 'performance_results_uri_en', NEW.performance_results_uri_fr, 'performance_results_uri_fr');

        IF errors = '{{}}' THEN
          RETURN NEW;
        END IF;

        RAISE EXCEPTION E'TAB-DELIMITED\t%', array_to_string(errors, E'\t');
      END;
  - update_record_modified_created_trigger

  trigger_strings:  # yaml | not supported
    target_error: This field must be a single number between 0 and 1 representing a percentage.
    negative_number_error: This value must not be negative
    max_length_error: This field has a maximum length of {} characters.
    invalid_choice_error: 'Invalid choice: {}'
    number_requied_error:  Number required
    integer_type_error: 'Invalid input syntax for type integer: {}'
    conditional_required_error: This field is required due to a response in a different field.
    both_lang_error: This text must be provided in both languages
    service_id_comma_error: Comma is not allowed in Service ID Number field
    service_standard_id_comma_error: Comma is not allowed in Service Standard ID field
    volume_error: Volume Meeting Target can not exceed Total Volume.

  examples:
    record:
      fiscal_yr: 2022-2023
      service_id: '1001'
      service_name_en: Old Age Security (OAS) Benefits
      service_name_fr: Prestations de la Sécurité de la vieillesse
      service_standard_id: '925'
      service_standard_en: OAS basic benefits are paid within the first month of entitlement
      service_standard_fr: Les prestations de base de la SV sont versées au cours du premier mois d’admissibilité.
      type: TML
      channel: OTH
      channel_comments_en: Mail, Online, Person
      channel_comments_fr: Courrier, en ligne, personne
      target: 0.90
      volume_meeting_target: 315128
      total_volume: 359919
      comments_en: >
        The total volumes assessed against the first month of entitlement service standard
        excludes 3,550 decisions involving files submitted under international agreements
        and interactions with foreign governments.
      comments_fr: >
        Les volumes totaux évalués par rapport à la norme de service du premier mois de
        droit excluent 3 550 décisions concernant des dossiers soumis dans le cadre d'accords
        internationaux et d'interactions avec des gouvernements étrangers.
      standards_targets_uri_en: https://www.canada.ca/en/employment-social-development/corporate/transparency/service-standards-2018-2019.html#h2.25
      standards_targets_uri_fr: https://www.canada.ca/fr/emploi-developpement-social/ministere/transparence/normes-service-2018-2019.html#h2.21
      performance_results_uri_en: Not applicable
      performance_results_uri_fr: Not applicable

excel_edge_style:
  PatternFill:
    patternType: solid
    fgColor: FF002C54
excel_header_style:
  PatternFill:
    patternType: solid
    fgColor: FFEFBD09
excel_column_heading_style:
  PatternFill:
    patternType: solid
    fgColor: FFEFBD09

